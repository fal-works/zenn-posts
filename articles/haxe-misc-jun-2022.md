---
title: "プログラミング言語 Haxe 四方山話"
emoji: "🗻"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["haxe"]
published: false
---

# 序

ドイツ語で魔女のことを Hexe（ヘクセ）と言う。

一説には、Hexe の語源は「柵」「垣根」などを意味する言葉であったらしい。村落などの内と外を分ける境界線というわけである。ある時代の人間にとって、村の外側というのは現代人の想像が及ばないレベルで危険な環境であった。また、村からほとんど出ずに生涯を終える人も珍しくなかったのである。それも踏まえると、土地の「境界」という概念、またはそれを象徴するような自然物や人工物に、なんらかの呪術的な意味が見出されたであろうことは想像に難くない（ゲド戦記を読んだ人なら「石垣の向こう」が思い出されるはずである）。その境界の内外を、現界と異界を、生と死を、自在に行き来できる存在。それを魔女と呼んだのであった。[^hexe]

[^hexe]: Hexe の語源の話はたしか小学館プログレッシブ独和辞典の豆知識コラムで読んだのだったと記憶しているけど、なにぶん相当前のことなので詳細は覚えていない。

そういえば西遊記にも有来有去という妖怪がいたことを連想的に思い出した。が、そこまでの含意のある名前なのかどうかは確認できていない。悟空に一撃でやられ、これでは有来有去ではなく有去無来じゃわいワッハッハとか言われていたことだけ覚えている。

ところで以上の話は本題とまったく関係がない。

プログラミング言語 Haxe の話を書くのだった。

https://haxe.org/


# Haxe、なんと読むのか

まずは Wikipedia の記事を見てみよう。

https://ja.wikipedia.org/wiki/Haxe

Haxe の読みは「ヘックス」だという記述がある。どうも昔は公式サイトにもそう書いてあったようだ[^pronounce_official]。古い情報として、開発者の Nicolas Cannasse 氏が「自分は hex と読んでます」と書いていたことがあり[^pronounce_nicolas]、たぶんそれが大元なのではないかと思われる。

しかし開発者氏が動画でしゃべっているのを聞く限りではアクスと読んでいる[^pronounce_video]（氏はフランスの人だ。フランス語で読むとこうなる）。最初からかもしれないし、年数が経過するうちに途中で思い直したのかもしれない。なお、現在の公式サイトではもはや何も言及されていないようなので、もう別になんでもよいのだろう。なんとなく、たぶん英語圏では hæks[^ax] と読む人が多いのではないかという印象、これはアメリカ英語[^american]ならヘックスと聞こえんこともないはずだ。

[^pronounce_official]: 昔の公式サイトの記述： <https://web.archive.org/web/20130102205718/http://haxe.org/doc/intro/>
[^pronounce_nicolas]: 開発者氏の昔のコメント： 1. <https://web.archive.org/web/20061112154557/http://osflash.org/pipermail/osflash_osflash.org/2005-December/006140.html> , 2. <https://web.archive.org/web/20070328232003/http://lists.motion-twin.com/pipermail/haxe/2007-March/007897.html>
[^pronounce_video]: 開発者氏の動画： <https://youtu.be/-WeGME_T9Ew>
[^ax]: 斧を意味する英単語 ax に h を付けた感じ。
[^american]: ジャパンがジュペアンになるのだから面白い。あれはあれで一定の規則があるのだ。とはいえ本当にネイティブの感覚で話されたら私の英語力ではまったく聞き取れないとは思う。ちなみにドイツ人が英語を話そうとすると æ が ɛ に近づく傾向があるのだけど、さすがにこれは関係なさそうだ。

ところで私は、Haxe を使って小さなゲームを個人制作し、東京ゲームショウというイベントで展示してみたことがある。

https://store.steampowered.com/app/910730/Solid_Aether

その展示の折、来場者の一人から英語で「ゲームエンジンは何を使いましたか」と尋ねられたということがあった。「ヘックスで作りました、そういうプログラミング言語です」と答えた[^openfl]。すると、どうやら私は、バイナリエディターかなにかを使ってゲームプログラムを16進数(hex)の機械語で書き上げてしまうとんでもないマッドプログラマーだと思われたらしく、後日興奮した様子でツイートされていたのを発見した[^hex]。私が訂正するまでもなく「Haxe のことでは？」というつっこみが入っていた。むしろよく分かったものである。

[^openfl]: OpenFL や HaxeFlixel といったゲーム作成用ライブラリーも使っていて、それらをゲームエンジンと呼べんこともないけれど、Unity あたりと近いレイヤーで答えるならプログラミング言語に言及するだけで良いだろう。
[^hex]: [HEX](https://github.com/mazj/hex) というそのものズバリなプログラミング言語も見つけたけど、単なる個人プロジェクトのようだし、これのことではないだろう。「この現代にそんなことをする人がいるなんて！」という書かれ方だった。

そういうわけで、読み方についてはそのときどきで誤解のないようにやるしかあるまいという感じである。私の脳内ではハクスとかハクセとかヘックスとかヘッキシとかその場その場で適当に読んでいる。


# Haxe 今昔

以下は別に時系列ではない。

## altJS としての Haxe

Haxe について昔の情報を漁ってみると、10年くらい前の altJS 戦国時代 ―― TypeScript がまだ主流でなかった頃 ―― には、どうやら Haxe が日本語圏でも一定の存在感を持っていたらしいことがうかがえる。当時の資料としては、たとえば次のスライドなど。

https://www.slideshare.net/sipojp/haxe-24876418

Twitter で当時のツイートを検索[^twitter_query]すると、明らかに今より多くの言及がある。さながら、古代都市の遺跡に残された残留思念を読み取って[^fanastasis]、人がまだ生を営んでいた時代の往来の喧騒に想いを馳せるような、ある種の歴史的ロマンといった風情である[^geneki]。

Haxe は別に altJS 特化の技術というわけではないので、その後 JavaScript のエコシステムを前提にした TypeScript が altJS の主流となったのも自然な成り行きだったとは思う。とはいえ、それ以外の文脈で Haxe への言及があまり見られないのは、なんだか少し寂しい感じもする。

[^twitter_query]: 適当なTwitter検索クエリー： `Haxe until:2014-12-31 lang:ja OR @i -@haxe`
[^fanastasis]: フリゲ勢は Fanastasis をやろう。<https://www.freem.ne.jp/win/game/21044>
[^geneki]: 現役の人からしたらあんまりな言い草ではある。

## altFlash としての Haxe

元を辿ると Haxe の出自は、ActionScript の代替として開発されたものであった（2005年、[Wikipedia調べ](https://ja.wikipedia.org/wiki/Haxe)）。

私は Flash 文化との接点がなかったので肌感もあまりないのだけど、たとえば『ステラのまほう』のくろば・U先生が Haxe への移植を試みた（が挫折してしまった）という記録がある。

http://zenpo-huchui.com/d170908

Haxe は ActionScript よりはだいぶ厳格みたいなので[^strict]、作り込んでしまったものを移植しようとすると相当厳しいのだろう。私からすると Haxe はむしろ緩すぎる（特に null 安全性！）のだけど、こういう経緯だと仕方ないかあという感じはする。よく言われていることだが、この点 TypeScript は JavaScript から一切手を加えずに移植でき、後から好きなタイミングで厳しさを細かく調節できて、このあたり善し悪しはあれど、やはり偉いというほかない。移植はともかくとしても、厳しさ調節機能は私も欲しい。

[^strict]: もしかしたら最初期はそう厳格でもなかったのかもしれない。10年の開きがあればさすがにいろいろ違うはずだ。

ところで上記の記事には、Haxe で `Int` 同士の割り算をすると整数除算が行われず `Float` に変わるのはどういうことだ！？[^divint]　という話も含まれているが、これはむしろ堅い言語の出身者のほうが驚くポイントかもしれず、また別の問題として考えることもできる。Haxe は複数の言語にトランスパイル可能とするため、静的・動的を問わずいろんな言語の最大公約数的な仕様を採用するところがある。これも考えようによっては面白いのだけど、実際のところ、一人一人のユーザーが Haxe に期待する用途はそれぞれ大して広くないので、主観的にはナンジャコリャとなりやすいところでもある。

[^divint]: この例に関して言うと、`Std.int()` で囲めば、よしなに最適化しつつ `Int` にキャストしてくれる。その一手間を許容できるかは別ではある。

## 私にとっての Haxe

私が Haxe に手を出したのは2018年のことで、altJS/altFlash とはまた別の理由からだった。

altJava ……じゃないけど、要するに一つのソースコードから複数の環境に向けて実行可能ファイルを吐くことができて、かつ吐き出されたものがごちゃごちゃしておらずスタンドアローンで、さらにはゲームとかを比較的簡単に作れるような環境が整っているといいな、といったニーズだった。選択肢をいろいろ比較検討したわけではないし、いま考えるとこれらは別に Haxe の特徴という感じでもないかもしれない。

まあ技術力自体ほぼ無い状態の私が、言語の存在を知ってから2週間で下のツイートのようなものを作れる程度には整っていたので、失敗ではなかったと言える。

https://twitter.com/falworks_ja/status/973946658290417669

なおあまり環境依存なことをしなければ下のツイートのように、ネイティブな実行可能ファイルも吐けるし、Webブラウザーで動く JavaScript コードも吐けるので、そのへん場合によっては嬉しいかもしれない。

https://twitter.com/falworks_ja/status/1283020999705759745

ここまで書いたものの、私自身、バージョン 3.x 時点の Haxe には不満があって、あのままだったら他に乗り換えていたかもしれない。

2019年に Haxe 4.0 が出た。4.x 系も決して理想ではないけれど、そこそこ気に入ってはいる。

## 最近の Haxe

下記は最近の日本語文献の一つ。

https://speakerdeck.com/terurou/haxezui-xin-shi-qing-2021nian-1yue-ban

Haxe の仕様やコンパイラーは、決してスピーディーにとは行かないけれど、今なお少しずつ改善されていっている。

企業やOSSにおける採用事例に関しては私のほうでは調べていないので、特に他の情報は持っていない。唯一あるとすれば、春頃に PlantUML の後継版を Haxe で作りますという話を見かけたのだけれど、今のところリポジトリーの状況にはまだ変化が無いようだ。

https://github.com/plantuml/plantuml2


# Hello World in Haxe

これを読んでさあ Haxe を始めようという人はなかなかいないとは思うけれど、とりあえず使ってみるだけなら簡単なので、最後にその流れだけ書いておく。

**Step 1**
まず[公式サイト](https://haxe.org/)から Haxe をダウンロード＆インストールする[^lix]。
そしてコマンドラインで `haxe` コマンドが使えることを確認する。

[^lix]: 最近の私は Haxe を手動インストールせず、[lix](https://github.com/lix-pm/lix.client) というパッケージマネージャーを使って入れている。バージョン切り替えがしやすいし、ライブラリー管理も（標準のやつよりは）効率化できて便利。

**Step 2**
たとえば下のようなコードを書いて保存する。

```haxe
function main() {
    Sys.println("Hello, world!");
}
```

ここでは仮に `Main.hx` というファイル名で保存するとしよう（ファイル名がすなわちモジュール名となり、このコードは `Main` という名前のモジュールであるという扱いになる）。

**Step 3**
`Main.hx` と同じディレクトリーにて、次のコマンドを実行すれば……

```sh
haxe --main Main --interp
```

無事 Hello world が発動する。

```plaintext
Hello, world!
```

これで全国十余名[^few]の Haxe 使いの仲間入りだ！

`--interp` のあたりを変更したり[^compilertarget]、必要なライブラリーを入れたりすると[^haxelib]、C++ や JavaScript など別の言語にトランスパイルできるのだが、そこから先はまた別の物語である。

[^few]: このような過少申告は慎むべきかもしれない。しかし実際何人くらいいるのかは定かではない。
[^compilertarget]: コンパイル先ターゲットその他のオプション説明： <https://haxe.org/manual/compiler-usage.html>
[^haxelib]: Haxe のライブラリー集積地（JavaScript で言うところの npm）： <https://lib.haxe.org/>
